1
00:00:00,080 --> 00:00:27,040
三天前，我發布了一支展示 Claude Code 各個層級的影片，結果大受歡迎。但我遺漏了一個關鍵的東西，如果你想正確使用 Claude Code 就必須了解它，那就是 Agent Teams。從那之後，我深入研究了官方文件並親自動手測試，一旦搞懂這個概念，完全改變了我對如何在專案中使用 Claude Code 的想法。因為如果你像大多數人一樣只用單一代理來跑，你可能已經注意到跟我一樣的問題——跑得越久，表現越差。

2
00:00:27,040 --> 00:00:53,360
它會遺忘上下文、引入 bug，還逼你不斷重複同樣的指示。所以在這支影片中，我會拆解 Claude 的 Agent Teams 到底是什麼、為什麼會存在，以及什麼時候該用 Agent Teams、什麼時候該用子代理或單一代理，讓你能更快地建構可靠的系統。那我們直接開始吧。你塞進單一代理上下文視窗的資訊越多，它的表現就越差，模型也越難專注在當下真正重要的事情上。

3
00:00:53,360 --> 00:01:18,800
當這個小小的上下文進度條逐漸填滿，你就會遇到上下文耗盡的問題，當它到達大約 95% 時，就會壓縮並摘要重要資訊。接下來的對話只會使用這些摘要，這意味著它最終再也找不到你在幾千個 token 之前提供的那些關鍵細節了。現在想像一下，在一個更大的專案中，所有關鍵細節都很重要，而不只是讓 Claude Code 執行一個獨立任務，這會造成多大的損害。

4
00:01:18,800 --> 00:01:43,360
所以單一代理會不堪負荷、會遺忘，而社群中的專家們很早就發現了這個問題，開始建構他們自己的子代理系統。使用子代理基本上只有兩個原因。第一個是提升輸出品質，就像是聘請專才而不是通才。我們可以讓一個 Claude 負責調度，委派給同一個工作階段中各自擁有獨立上下文視窗的專業化實例。

5
00:01:43,360 --> 00:02:10,240
因此我們可以提升輸出品質，同時也能降低成本，因為我們不需要把所有上下文都餵給那些專業化的子代理。第二個原因是加快速度。不是讓它們之間來回傳遞資訊，而是讓它們平行運作，開兩個終端機視窗，處理彼此不相依的任務。比如說，在終端機一中，我們可以讓它撰寫 LinkedIn 貼文；在終端機二中，同時平行地讓它處理 Instagram 貼文，這兩者通常是不相關的。

6
00:02:10,240 --> 00:02:33,840
像 Boris Cherny——Claude Code 的創造者——以及社群中其他的進階用戶，他們都透過建構自己的子代理系統來解決這個問題。Boris 甚至說他同時跑了多達 15 個代理，五個平行跑在終端機裡，另外五到十個 Claude 同時在線上運作。這在理論上很棒，但當代理之間真的需要互相溝通時就崩潰了。因為子代理只能回報給父代理。

7
00:02:33,840 --> 00:03:01,920
舉例來說，假設我們有一個內容研究團隊，研究員是子代理一，寫手是我們的主要實例，審稿員是子代理二。這些子代理——研究員和審稿員——只能把資訊回傳給主要實例，也就是寫手。審稿員無法審查研究成果，研究員也看不到審稿員的任何輸出，全部由寫手來處理。所以使用子代理，你最終會發現主代理變成了瓶頸——主代理和每一個專業子代理之間只有雙向溝通。

8
00:03:01,920 --> 00:03:29,960
所以當我們啟動子代理時，每個子代理都有自己的上下文，結果會回傳給我們的主代理——在我們的例子中就是寫手，然後審稿員和研究員作為子代理。但主代理負責協調所有這些工作，所以如果多個任務和多個子代理都回饋到那個主代理，它就會成為明顯的瓶頸。而且這只在你不需要研究員和審稿員互相交流的情況下才行得通。所以子代理就像一個輻射式模型，它們給了我們委派的能力，

9
00:03:30,200 --> 00:03:59,960
但沒有給我們協作的能力。而這正是 Agent Teams 填補的缺口。它們透過共享任務清單來實現這一點。主代理會決定並啟動隊友，也就是我們的子代理。但不同的是，它們有這個共享任務清單，能夠與每一個隊友來回溝通。不僅如此，隊友之間也能夠互相溝通。所以你可以把它想成一個子代理架構，但增加了不僅能跟主代理溝通，還能從共享任務清單中取得任務，

10
00:04:00,040 --> 00:04:28,040
並且彼此之間互相溝通的能力。所以同樣地，它們有自己的上下文視窗，但實際上，它們不是把所有資訊回傳給主代理，而是被設置為各自獨立的 Claude Code 實例。不過這也有缺點——它們可以存取主代理所能存取的一切，包括 Claude.md 檔案、MCP 等等。但代價是我們必須把這些全部放進每一個啟動的子代理或隊友的上下文中，所以最終會花費更多 token。好了，現在你知道它是什麼了，讓我們來實際設定吧。

11
00:04:28,200 --> 00:04:52,400
順帶一提，這個功能還非常實驗性。首先我們需要做一件事，就是在 settings.json 檔案中啟用它。我們這裡已經開了一個 Claude Code 實例，進入 settings.json 檔案，把 Claude Code experimental agent teams 這個選項設為 true。接著我們需要重新啟動 Claude 實例。在重新啟動之前，先確認一下是最新版本的 Claude，所以我們來執行 Claude update。

12
00:04:52,640 --> 00:05:15,480
它會確保我們的版本在 2.1.32 之後，否則即使你在設定中開了那個旗標，也無法使用 Agent Teams。然後我們要加上 dangerously skip permissions 這個旗標來執行，因為我們不想每次檔案變更都要手動核准。那麼，說到實際啟動一個團隊，我們可以明確告訴 Claude 我們要什麼——我們要一個研究代理、一個寫手代理——或者就讓它自己決定，給它一個任務範圍就好。

13
00:05:15,600 --> 00:05:37,360
在這一步你必須明確告訴它你想要一個 Agent Team，或至少在你的提示詞中暗示這一點。我嘗試了幾個不同的使用情境，試著理解什麼時候該用完整的 Agent Team、什麼時候用子代理、什麼時候用單一代理。我有幾個例子——商業用途、內容創作——這些是我覺得說到底其實不太需要動用 Agent Teams 的情況。

14
00:05:37,560 --> 00:06:00,400
然後是更複雜、更相互交織的情境，在這些場景中協作更加重要，也就是適合使用 Agent Teams 的六分或八分情境。所以一個兩分的使用情境基本上就是建立一個 Agent Team，從 Airtable 內容行事曆中提取點子。它啟動四個隊友——一個寫 LinkedIn 貼文、一個寫 Instagram 貼文、一個做深度研究，然後一個審稿員來檢查草稿。

15
00:06:00,400 --> 00:06:28,040
這基本上就是一組上下文提示詞組合在一起，不太需要各方之間的協作——LinkedIn 貼文寫手不一定需要跟 Instagram 貼文寫手溝通。他們可能需要一些深度研究，但其實，這能不能在一個獨立的步驟中完成，然後分別傳給各個寫手作為子代理？大概可以。所以這就是為什麼我把它歸為兩分的使用情境。六分的使用情境，也就是需要更多協作的場景，可能是從影片逐字稿進行內容再利用。

16
00:06:28,040 --> 00:06:53,400
比如我可以載入這支影片的逐字稿。隊友一負責撰寫 Markdown 格式的長文部落格文章，它會提取關鍵框架、為 SEO 做結構化處理，確保我們可以上傳到 WordPress 或 Webflow，不管網站在哪裡。隊友二專門負責 LinkedIn 輪播貼文，實際生成圖片、吸引眼球的開頭和輪播的敘事角度。然後隊友三可能負責撰寫針對你的受眾量身定制的電子郵件電子報。

17
00:06:53,400 --> 00:07:19,520
這些都是相當獨立的任務，可以用子代理來跑，但之所以這是六分而不是兩分的使用情境，是因為你其實希望它們的輸出保持一致性。所以隊友一、二、三可能需要在一些事情上進行協作，比如吸引眼球的角度要怎麼定，這樣我們才能不是完全複製，而是在這方面保持相似性。而且它們也可以檢查彼此的檔案，確保所有素材的訊息傳達保持一致。

18
00:07:19,600 --> 00:07:42,920
而 Agent Teams 真正大放異彩的地方，也就是我所說的八分使用情境，是建構更複雜的東西，你確實需要協作的場景。比如一個整合 Stripe 的 Next.js 應用程式。隊友一負責建構包含所有端點和 webhook 的 API 層。隊友二只負責建構前端，專精於前端的東西，不會有任何後端的上下文灌進來。隊友三則負責撰寫完整的測試套件。

19
00:07:43,120 --> 00:08:09,760
而且在建構 API 層和前端的過程中，它們會持續跟隊友三溝通，隊友三負責進行測試，然後把結果回饋到任務清單中。為了讓你看看實際跑起來是什麼樣子，我們要複製第二個使用情境，然後指定「建立一個 Agent Team 來」，接著把內容貼進去。現在，如果我們已經重新啟動實例，而且 settings.json 中開了那個旗標表示我們要使用團隊，它就會理解。

20
00:08:09,920 --> 00:08:37,320
我們指定了要一個 Agent Team，它現在就會去建立那些個別的隊友。我們把影片的實際逐字稿丟進去，它會生成隊友，然後這些隊友會彼此互動，在長文文章、五張 LinkedIn 輪播貼文腳本以及電子郵件電子報之間建立一致的訊息傳達，接著啟動那些個別的隊友。我們會看到所有隊友在平行運作，而且可以在它們之間切換瀏覽。

21
00:08:37,320 --> 00:09:05,120
你可以用 Shift+上 和 Shift+下 來指定隊友，個別對話並指派任務給特定的隊友。我們可以中斷特定的隊友，直接跟它們對話。這讓我們能夠運行一個 Agent Team，它們之間互相協作，但我們也能控制並提供輸入。不過，除非你安裝了 Tmux 之類的工具，否則它們全部會出現在同一個終端機視窗裡。如果你安裝了 Tmux，它就會分成各個獨立的視窗。

22
00:09:05,200 --> 00:09:29,920
這樣你就可以看到每個代理接收到的上下文以及它即時完成的工作。所以它已經平行設置好了三個內容隊友——部落格寫手隊友、輪播寫手隊友和電子報寫手。它會分配個別的任務，指定一個要完成的輸出檔案。然後它們就會開始互相交流，跨團隊協調已經內建好了。部落格寫手會把它的吸睛角度傳給輪播寫手，這樣它們就不會重複。

23
00:09:30,080 --> 00:09:55,800
電子報寫手會檢查另外兩份草稿以保持訊息一致，但採取不同的角度，三者全部遵循相同的品牌語調、品牌用詞清單、人性化規則，而且不使用破折號。三個全部完成後，會經過審查階段來標記任何矛盾之處、檢查品牌語調，並確保每篇內容真的採取了不同的角度，而不只是同一內容的縮短版。這裡很棒的一點是，在同一個視窗中就能看到所有正在進行的動作。

24
00:09:55,800 --> 00:10:19,800
比如我們可以看到輪播寫手的動作，然後可以看到部落格寫手的動作，而這兩者是同時在平行運行的。如果我們想在不同的視窗中查看它們，看到各個代理的進度，那我們只要用 brew install 安裝一個叫 Tmux 的工具，它可以讓我們在不同的終端機視窗中看到各個代理。但因為我們使用的是標準的 VS Code 終端機，所以可以在同一個視窗中看到全部。

25
00:10:19,840 --> 00:10:47,800
如果我們想在隊友之間切換並給予特定指示，可以按 Shift+上，就能看到我們在 Team Lead、部落格寫手、輪播寫手、電子報寫手等之間切換。如果我們想給特定的隊友提供資訊，比如 Team Lead，就按 Enter，然後跟 Team Lead 對話並給出那些特定的指示。當然我們也可以中斷它們的工作階段，但重點是我們仍然掌控著這個平行運作的團隊。

26
00:10:47,800 --> 00:11:15,200
這很重要，因為當我們使用子代理時，我們通常是跟 Team Lead 對話。但當我們使用 Agent Teams 時，我們可以直接跟個別的團隊成員對話。所以只要 settings.json 中的一個設定、一個提示詞，你就擁有了一個協調有序的 AI 代理團隊在平行運作，而且它們全都在互相溝通。但重要的是要理解哪些任務確實適合用團隊，哪些只需要用子代理或單一代理就好。

27
00:11:15,200 --> 00:11:38,360
現在讓我們快速談談使用這種團隊方式的一些潛在限制。首先是沒有上下文繼承——被啟動的隊友不會拿到你主要工作流程的對話歷史。所以我們需要確保 Claude 傳遞給它們足夠充分的上下文，讓它們能夠完成工作。權限是會傳播的，所以如果我們一開始就開啟了跳過權限的設定，這會被傳遞給所有其他的隊友。

28
00:11:38,360 --> 00:12:04,560
比方說我們有一個審稿代理，我們不希望它實際進行編輯，那我們就需要去更改它的權限。當然，隊友之間的跨團隊協作意味著我們實際上會花更多 token。更多代理等於更多 token。所以只在任務達到八分或七分、確實需要 Agent Team 的時候才使用。還有，如果它們各自處理獨立的檔案那沒問題，但如果在同一個檔案中有跨團隊協作，它們實際上可能會互相覆寫。

29
00:12:04,560 --> 00:12:26,080
所以你需要確保它們之間有明確的分工。那問題來了——什麼時候該用 Agent Teams、什麼時候用子代理、什麼時候就用單一代理？我以後的做法是這樣的：直接了當的任務，只有一個檔案或幾個上下文檔案、一個功能、一段對話，我就用單一代理。而且我可以讓那個單一代理去啟動子代理。

30
00:12:26,320 --> 00:12:50,720
如果我需要專才，而且單一代理對話的上下文已經太大了，我就會擴展到子代理，這樣我們可以在那個品質水準下提升品質並降低成本，比如有一個研究員、寫手和審稿員。但當我需要更複雜的任務，比如建構一個 SaaS 應用程式，而且我需要速度和協調，有平行任務在進行，代理之間需要互相溝通，那我就會使用 Agent Teams。

31
00:12:50,720 --> 00:13:12,640
簡單來說就是：從簡單開始，隨著專案變得更複雜就升級到子代理，然後當任務真正需要跨團隊協作時再使用 Agent Teams。如果你還沒看過我原始的 Claude Code 影片，先去看那個，我會在上方附上連結。如果你想更深入地學習如何用這類工具建構可投入生產的系統，歡迎參加我的 AI Automation Academy，連結在下方說明欄中。
